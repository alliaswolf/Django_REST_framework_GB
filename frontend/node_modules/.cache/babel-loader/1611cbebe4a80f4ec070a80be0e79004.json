{"ast":null,"code":"import _regeneratorRuntime from\"/home/alex/\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B/DRF_GB/TODO_List/frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/alex/\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B/DRF_GB/TODO_List/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/alex/\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B/DRF_GB/TODO_List/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/alex/\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B/DRF_GB/TODO_List/frontend/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/alex/\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B/DRF_GB/TODO_List/frontend/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/alex/\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B/DRF_GB/TODO_List/frontend/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import\"./App.css\";import{UserList,UserListFilterId}from\"./components/Users\";import{ProjectList,ProjectListFilterId}from\"./components/Projects\";import{TodoList,TodoListFilterId}from\"./components/Todos\";import ProjectForm from\"./components/ProjectForm\";import TodoForm from\"./components/TodoForm\";import InfoList from\"./components/Home\";import MenuList from\"./components/Menu\";import Footer from\"./components/Footer\";import LoginForm from\"./components/Auth\";import axios from\"axios\";import Cookies from\"universal-cookie\";import{BrowserRouter,Route,Switch,Link}from\"react-router-dom\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var NotFound404=function NotFound404(_ref){var location=_ref.location;return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"h1\",{children:[\"\\u0421\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u0430 \\u043F\\u043E \\u0430\\u0434\\u0440\\u0435\\u0441\\u0443 '\",location.pathname,\"' \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u0430\"]})});};var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.state={username:\"Guest\",token:\"\",users:[],todos:[],projects:[],menu:[{id:1,link:\"/\",title:\"Home\"},{id:2,link:\"/user\",title:\"Users\"},{id:3,link:\"/todo\",title:\"Todos\"},{id:4,link:\"/project\",title:\"Projects\"}],textFooter:\"Footer text about something.\"};return _this;}_createClass(App,[{key:\"set_token_and_username\",value:function set_token_and_username(token,username){var _this2=this;var cookies=new Cookies();cookies.set(\"token\",token);cookies.set(\"username\",username);this.setState({token:token,username:username},function(){return _this2.load_data();});}},{key:\"is_authenticated\",value:function is_authenticated(){return!!this.state.token;}},{key:\"logout\",value:function logout(){var token=\"\";var username=\"Guest\";this.set_token_and_username(token,username);}},{key:\"get_token_and_username_from_storage\",value:function get_token_and_username_from_storage(){var _this3=this;var cookies=new Cookies();var token=cookies.get(\"token\");var username=cookies.get(\"username\");this.setState({token:token,username:username},function(){return _this3.load_data();});}},{key:\"get_token\",value:function get_token(username,password){var _this4=this;axios.post(\"http://127.0.0.1:8000/api-token-auth/\",{username:username,password:password}).then(function(response){_this4.set_token_and_username(response.data.token,response.data.username);}).catch(function(error){return alert(\"Code status is \".concat(error.response.status,\" - Invalid username or password\"));});}},{key:\"get_headers\",value:function get_headers(){var headers={\"Content-Type\":\"application/json\"};if(this.is_authenticated()){headers[\"Authorization\"]=\"Token \"+this.state.token;}return headers;}},{key:\"load_data\",value:function(){var _load_data=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var headers,users,todos,projects;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:headers=this.get_headers();users=[];todos=[];projects=[];_context.next=6;return axios.get(\"http://127.0.0.1:8000/api/users/\",{headers:headers}).then(function(response){users=response.data.results;}).catch(function(){users=[];});case 6:_context.next=8;return axios.get(\"http://127.0.0.1:8000/api/projects/todo/\",{headers:headers}).then(function(response){todos=response.data.results;}).catch(function(error){return console.log(console.log(error));});case 8:_context.next=10;return axios.get(\"http://127.0.0.1:8000/api/projects/project/\",{headers:headers}).then(function(response){projects=response.data.results;}).catch(function(error){return console.log(error);});case 10:this.setState({users:users,todos:todos,projects:projects});case 11:case\"end\":return _context.stop();}}},_callee,this);}));function load_data(){return _load_data.apply(this,arguments);}return load_data;}()},{key:\"createProject\",value:function createProject(title,link,usersWorked){var _this5=this;var headers=this.get_headers();var data={title:title,link:link,usersWorked:usersWorked};axios.post(\"http://127.0.0.1:8000/api/projects/project/\",data,{headers:headers}).then(function(response){alert(\"The project \\\"\".concat(response.data.title,\"\\\" created.\"));_this5.load_data();}).catch(function(error){alert(\"Code status is \".concat(error.response.status,\" - Error create.\"));});}},{key:\"createTodo\",value:function createTodo(title,text,isActive,author,project){var _this6=this;var headers=this.get_headers();var data={title:title,text:text,isActive:isActive,author:author,project:project};axios.post(\"http://127.0.0.1:8000/api/projects/todo/\",data,{headers:headers}).then(function(response){alert(\"The todo \\\"\".concat(response.data.title,\"\\\" created.\"));_this6.load_data();}).catch(function(error){alert(\"Code status is \".concat(error.response.status,\" - Error create.\"));});}},{key:\"editProject\",value:function editProject(id,title,link,usersWorked){var _this7=this;var headers=this.get_headers();var data={id:id,title:title,link:link,usersWorked:usersWorked};axios.patch(\"http://127.0.0.1:8000/api/projects/project/\".concat(id,\"/\"),data,{headers:headers}).then(function(response){alert(\"The project \\\"\".concat(response.data.title,\"\\\" edited.\"));_this7.load_data();}).catch(function(error){alert(\"Code status is \".concat(error.response.status,\" - Error edit.\"));});}},{key:\"deleteProject\",value:function deleteProject(id){var _this8=this;var headers=this.get_headers();axios.delete(\"http://127.0.0.1:8000/api/projects/project/\".concat(id,\"/\"),{headers:headers}).then(function(response){_this8.load_data();}).catch(function(error){console.log(error);alert(\"Code status is \".concat(error.response.status,\" - Error delete, project isn't empty.\"));_this8.load_data();});}},{key:\"deleteTodo\",value:function deleteTodo(id){var _this9=this;var headers=this.get_headers();axios.delete(\"http://127.0.0.1:8000/api/projects/todo/\".concat(id,\"/\"),{headers:headers}).then(function(response){_this9.load_data();}).catch(function(error){console.log(error);_this9.setState({todos:[]});});}},{key:\"componentDidMount\",value:function componentDidMount(){this.get_token_and_username_from_storage();}},{key:\"render\",value:function render(){var _this10=this;return/*#__PURE__*/_jsxs(\"div\",{className:\"container text-center\",children:[/*#__PURE__*/_jsxs(BrowserRouter,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"row pt-3 justify-content-end\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-3  align-self-end\",children:/*#__PURE__*/_jsxs(\"ul\",{className:\"list-group list-group-horizontal\",children:[/*#__PURE__*/_jsxs(\"li\",{className:\"list-group-item\",children:[\"Welcome \",/*#__PURE__*/_jsx(\"strong\",{children:this.state.username}),\"!\"]}),/*#__PURE__*/_jsx(\"li\",{className:\"list-group-item\",children:this.is_authenticated()?/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return _this10.logout();},children:\"Logout\"}):/*#__PURE__*/_jsx(Link,{to:\"/login\",children:/*#__PURE__*/_jsx(\"button\",{children:\"Login\"})})})]})})}),/*#__PURE__*/_jsx(MenuList,{menu:this.state.menu}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",component:function component(){return/*#__PURE__*/_jsx(InfoList,{users:_this10.state.users,projects:_this10.state.projects,todos:_this10.state.todos});}}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/login\",component:function component(){return/*#__PURE__*/_jsx(LoginForm,{get_token:function get_token(username,password){return _this10.get_token(username,password);}});}}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/user\",component:function component(){return/*#__PURE__*/_jsx(UserList,{users:_this10.state.users});}}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/project\",component:function component(){return/*#__PURE__*/_jsx(ProjectList,{projects:_this10.state.projects,users:_this10.state.users,deleteProject:function deleteProject(id){return _this10.deleteProject(id);}});}}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/todo\",component:function component(){return/*#__PURE__*/_jsx(TodoList,{todos:_this10.state.todos,deleteTodo:function deleteTodo(id){return _this10.deleteTodo(id);}});}}),/*#__PURE__*/_jsx(Route,{path:\"/project/:id\",children:/*#__PURE__*/_jsx(ProjectListFilterId,{projects:this.state.projects,users:this.state.users,deleteProject:function deleteProject(id){return _this10.deleteProject(id);},editProject:function editProject(id,title,link,usersWorked){return _this10.editProject(id,title,link,usersWorked);}})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/create/project\",component:function component(){return/*#__PURE__*/_jsx(ProjectForm,{titleForm:\"Create\",users:_this10.state.users,createProject:function createProject(title,link,usersWorked){return _this10.createProject(title,link,usersWorked);}});}}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/create/todo\",component:function component(){return/*#__PURE__*/_jsx(TodoForm,{users:_this10.state.users,projects:_this10.state.projects,createTodo:function createTodo(title,text,isActive,author,project){return _this10.createTodo(title,text,isActive,author,project);}});}}),/*#__PURE__*/_jsx(Route,{path:\"/todo/:id\",children:/*#__PURE__*/_jsx(TodoListFilterId,{todos:this.state.todos,deleteTodo:function deleteTodo(id){return _this10.deleteTodo(id);}})}),/*#__PURE__*/_jsx(Route,{path:\"/user/:id\",children:/*#__PURE__*/_jsx(UserListFilterId,{users:this.state.users})}),/*#__PURE__*/_jsx(Route,{component:NotFound404})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"navbar\",children:/*#__PURE__*/_jsx(Footer,{textFooter:this.state.textFooter})})]});}}]);return App;}(React.Component);export default App;","map":{"version":3,"sources":["/home/alex/Документы/DRF_GB/TODO_List/frontend/src/App.js"],"names":["React","UserList","UserListFilterId","ProjectList","ProjectListFilterId","TodoList","TodoListFilterId","ProjectForm","TodoForm","InfoList","MenuList","Footer","LoginForm","axios","Cookies","BrowserRouter","Route","Switch","Link","NotFound404","location","pathname","App","props","state","username","token","users","todos","projects","menu","id","link","title","textFooter","cookies","set","setState","load_data","set_token_and_username","get","password","post","then","response","data","catch","error","alert","status","headers","is_authenticated","get_headers","results","console","log","usersWorked","text","isActive","author","project","patch","delete","get_token_and_username_from_storage","logout","get_token","deleteProject","deleteTodo","editProject","createProject","createTodo","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport \"./App.css\";\nimport { UserList, UserListFilterId } from \"./components/Users\";\nimport { ProjectList, ProjectListFilterId } from \"./components/Projects\";\nimport { TodoList, TodoListFilterId } from \"./components/Todos\";\nimport ProjectForm from \"./components/ProjectForm\";\nimport TodoForm from \"./components/TodoForm\";\nimport InfoList from \"./components/Home\";\nimport MenuList from \"./components/Menu\";\nimport Footer from \"./components/Footer\";\nimport LoginForm from \"./components/Auth\";\nimport axios from \"axios\";\nimport Cookies from \"universal-cookie\";\nimport { BrowserRouter, Route, Switch, Link } from \"react-router-dom\";\n\nconst NotFound404 = ({ location }) => {\n  return (\n    <div>\n      <h1>Страница по адресу '{location.pathname}' не найдена</h1>\n    </div>\n  );\n};\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      username: \"Guest\",\n      token: \"\",\n      users: [],\n      todos: [],\n      projects: [],\n      menu: [\n        { id: 1, link: \"/\", title: \"Home\" },\n        { id: 2, link: \"/user\", title: \"Users\" },\n        { id: 3, link: \"/todo\", title: \"Todos\" },\n        { id: 4, link: \"/project\", title: \"Projects\" },\n      ],\n      textFooter: \"Footer text about something.\",\n    };\n  }\n\n  set_token_and_username(token, username) {\n    const cookies = new Cookies();\n    cookies.set(\"token\", token);\n    cookies.set(\"username\", username);\n    this.setState({ token: token, username: username }, () => this.load_data());\n  }\n\n  is_authenticated() {\n    return !!this.state.token;\n  }\n\n  logout() {\n    let token = \"\";\n    let username = \"Guest\";\n    this.set_token_and_username(token, username);\n  }\n\n  get_token_and_username_from_storage() {\n    const cookies = new Cookies();\n    const token = cookies.get(\"token\");\n    const username = cookies.get(\"username\");\n    this.setState({ token: token, username: username }, () => this.load_data());\n  }\n\n  get_token(username, password) {\n    axios\n      .post(\"http://127.0.0.1:8000/api-token-auth/\", {\n        username: username,\n        password: password,\n      })\n      .then((response) => {\n        this.set_token_and_username(\n          response.data.token,\n          response.data.username\n        );\n      })\n      .catch((error) =>\n        alert(\n          `Code status is ${error.response.status} - Invalid username or password`\n        )\n      );\n  }\n\n  get_headers() {\n    let headers = {\n      \"Content-Type\": \"application/json\",\n    };\n    if (this.is_authenticated()) {\n      headers[\"Authorization\"] = \"Token \" + this.state.token;\n    }\n    return headers;\n  }\n\n  async load_data() {\n    const headers = this.get_headers();\n    let users = [];\n    let todos = [];\n    let projects = [];\n\n    await axios\n      .get(\"http://127.0.0.1:8000/api/users/\", { headers })\n      .then((response) => {\n        users = response.data.results;\n      })\n      .catch(() => {\n        users = [];\n      });\n    await axios\n      .get(\"http://127.0.0.1:8000/api/projects/todo/\", { headers })\n      .then((response) => {\n        todos = response.data.results;\n      })\n      .catch((error) => console.log(console.log(error)));\n    await axios\n      .get(\"http://127.0.0.1:8000/api/projects/project/\", { headers })\n      .then((response) => {\n        projects = response.data.results;\n      })\n      .catch((error) => console.log(error));\n    this.setState({\n      users: users,\n      todos: todos,\n      projects: projects,\n    });\n  }\n  createProject(title, link, usersWorked) {\n    const headers = this.get_headers();\n    const data = { title: title, link: link, usersWorked: usersWorked };\n    axios\n      .post(\"http://127.0.0.1:8000/api/projects/project/\", data, { headers })\n      .then((response) => {\n        alert(`The project \"${response.data.title}\" created.`);\n        this.load_data();\n      })\n      .catch((error) => {\n        alert(`Code status is ${error.response.status} - Error create.`);\n      });\n  }\n  createTodo(title, text, isActive, author, project) {\n    const headers = this.get_headers();\n    const data = {\n      title: title,\n      text: text,\n      isActive: isActive,\n      author: author,\n      project: project,\n    };\n    axios\n      .post(\"http://127.0.0.1:8000/api/projects/todo/\", data, { headers })\n      .then((response) => {\n        alert(`The todo \"${response.data.title}\" created.`);\n        this.load_data();\n      })\n      .catch((error) => {\n        alert(`Code status is ${error.response.status} - Error create.`);\n      });\n  }\n  editProject(id, title, link, usersWorked) {\n    const headers = this.get_headers();\n    const data = { id: id, title: title, link: link, usersWorked: usersWorked };\n    axios\n      .patch(`http://127.0.0.1:8000/api/projects/project/${id}/`, data, {\n        headers,\n      })\n      .then((response) => {\n        alert(`The project \"${response.data.title}\" edited.`);\n        this.load_data();\n      })\n      .catch((error) => {\n        alert(`Code status is ${error.response.status} - Error edit.`);\n      });\n  }\n  deleteProject(id) {\n    const headers = this.get_headers();\n    axios\n      .delete(`http://127.0.0.1:8000/api/projects/project/${id}/`, { headers })\n      .then((response) => {\n        this.load_data();\n      })\n      .catch((error) => {\n        console.log(error);\n        alert(\n          `Code status is ${error.response.status} - Error delete, project isn't empty.`\n        );\n        this.load_data();\n      });\n  }\n  deleteTodo(id) {\n    const headers = this.get_headers();\n    axios\n      .delete(`http://127.0.0.1:8000/api/projects/todo/${id}/`, { headers })\n      .then((response) => {\n        this.load_data();\n      })\n      .catch((error) => {\n        console.log(error);\n        this.setState({ todos: [] });\n      });\n  }\n\n  componentDidMount() {\n    this.get_token_and_username_from_storage();\n  }\n\n  render() {\n    return (\n      <div className=\"container text-center\">\n        <BrowserRouter>\n          <div className=\"row pt-3 justify-content-end\">\n            <div className=\"col-3  align-self-end\">\n              <ul className=\"list-group list-group-horizontal\">\n                <li className=\"list-group-item\">\n                  Welcome <strong>{this.state.username}</strong>!\n                </li>\n                <li className=\"list-group-item\">\n                  {this.is_authenticated() ? (\n                    <button onClick={() => this.logout()}>Logout</button>\n                  ) : (\n                    <Link to=\"/login\">\n                      <button>Login</button>\n                    </Link>\n                  )}\n                </li>\n              </ul>\n            </div>\n          </div>\n          <MenuList menu={this.state.menu} />\n          <Switch>\n            <Route\n              exact\n              path=\"/\"\n              component={() => (\n                <InfoList\n                  users={this.state.users}\n                  projects={this.state.projects}\n                  todos={this.state.todos}\n                />\n              )}\n            />\n            <Route\n              exact\n              path=\"/login\"\n              component={() => (\n                <LoginForm\n                  get_token={(username, password) =>\n                    this.get_token(username, password)\n                  }\n                />\n              )}\n            />\n            <Route\n              exact\n              path=\"/user\"\n              component={() => <UserList users={this.state.users} />}\n            />\n            <Route\n              exact\n              path=\"/project\"\n              component={() => (\n                <ProjectList\n                  projects={this.state.projects}\n                  users={this.state.users}\n                  deleteProject={(id) => this.deleteProject(id)}\n                />\n              )}\n            />\n            <Route\n              exact\n              path=\"/todo\"\n              component={() => (\n                <TodoList\n                  todos={this.state.todos}\n                  deleteTodo={(id) => this.deleteTodo(id)}\n                />\n              )}\n            />\n            <Route path=\"/project/:id\">\n              <ProjectListFilterId\n                projects={this.state.projects}\n                users={this.state.users}\n                deleteProject={(id) => this.deleteProject(id)}\n                editProject={(id, title, link, usersWorked) =>\n                  this.editProject(id, title, link, usersWorked)\n                }\n              />\n            </Route>\n            <Route\n              exact\n              path=\"/create/project\"\n              component={() => (\n                <ProjectForm\n                  titleForm=\"Create\"\n                  users={this.state.users}\n                  createProject={(title, link, usersWorked) =>\n                    this.createProject(title, link, usersWorked)\n                  }\n                />\n              )}\n            />\n            <Route\n              exact\n              path=\"/create/todo\"\n              component={() => (\n                <TodoForm\n                  users={this.state.users}\n                  projects={this.state.projects}\n                  createTodo={(title, text, isActive, author, project) =>\n                    this.createTodo(title, text, isActive, author, project)\n                  }\n                />\n              )}\n            />\n            <Route path=\"/todo/:id\">\n              <TodoListFilterId\n                todos={this.state.todos}\n                deleteTodo={(id) => this.deleteTodo(id)}\n              />\n            </Route>\n            <Route path=\"/user/:id\">\n              <UserListFilterId users={this.state.users} />\n            </Route>\n            <Route component={NotFound404} />\n          </Switch>\n        </BrowserRouter>\n        <div className=\"navbar\">\n          <Footer textFooter={this.state.textFooter} />\n        </div>\n      </div>\n    );\n  }\n}\nexport default App;\n"]},"metadata":{},"sourceType":"module"}